"use strict";(self.webpackChunkreact_rule_tree=self.webpackChunkreact_rule_tree||[]).push([[712],{35973:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(16855),g=e(46451),f=e(55241),C=e(96365),h=e(86738),c=e(71577),D=e(34041),E=e(67294),P=e(91872),T=e(2903),t=e(85893),u=g.Z.useForm,v=function(K){return(0,t.jsx)(f.Z,{title:(0,t.jsx)(C.Z,{value:K.value,onChange:function(i){K.onChange(i.target.value)}}),children:K.value})};O.default=function(){var A=u(),K=m()(A,1),I=K[0],i=(0,E.useRef)(),L=(0,E.useState)({relation:"and",children:[{name:"1"},{name:"2"},{relation:"and",children:[{name:"foo"},{name:"bar"}]}]}),x=m()(L,2),W=x[0],y=x[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,t.jsx)(g.Z,{form:I,onValuesChange:function(ue,re){console.log(re),y(re.rule)},children:(0,t.jsx)(g.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:W,required:!0,children:(0,t.jsx)(P.ZP,{actionRef:i,fields:[{name:"name",rules:[{required:!0}],initialValue:"1",render:function(ue,re,w){return(0,t.jsx)(v,{},"test-".concat(w.index))}}],actionsRender:function(ue,re){return ue.type==="FIELD"?{remove:(0,t.jsx)(h.Z,{title:"\u4E11\u5417\uFF1F\u4E11\u5C31\u5BF9\u4E86",onConfirm:function(){re.remove()},children:(0,t.jsx)(c.ZP,{style:{backgroundColor:"#"+(Math.random()*16777215<<0).toString(16)},disabled:ue.disabled,children:"remove"})})}:{}},relationWidth:130,relation:function(){return(0,t.jsxs)(D.Z,{style:{width:72},children:[(0,t.jsx)(D.Z.Option,{value:"and",children:"AND"}),(0,t.jsx)(D.Z.Option,{value:"or",children:"OR"})]})}})})})}),(0,t.jsx)(j.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(W),valueType:"jsonCode"})]})}},10187:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(67294),h=e(91872),c=e(85893),D=j.Z.useForm;O.default=function(){var E=D(),P=m()(E,1),T=P[0];return(0,c.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,c.jsxs)(j.Z,{form:T,onValuesChange:function(u,v){console.log(v)},children:[(0,c.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"1"}]},required:!0,children:(0,c.jsx)(h.ZP,{fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,c.jsx)(g.Z,{style:{height:32}})}},{name:"hide",render:function(){return!1}},{name:"sex",initialValue:"0",render:function(u){var v=u.getFieldValue("name");return v==="love"?(0,c.jsx)("div",{children:"is just a lie."}):(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,c.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(u){var v=u.isRoot;return(0,c.jsxs)(f.Z,{style:{width:72},bordered:v,children:[(0,c.jsx)(f.Z.Option,{value:"and",children:"AND"}),(0,c.jsx)(f.Z.Option,{value:"or",children:"OR"})]})}})}),"\u5C1D\u8BD5\u8F93\u5165 love"]})})}},17109:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(52074),g=e(16855),f=e(46451),C=e(84567),h=e(96365),c=e(34041),D=e(67294),E=e(91872),P=e(85893),T=f.Z.useForm,t=function(v){var A=v.value,K=v.onChange;return(0,P.jsx)(C.Z,{checked:A,onChange:function(i){K(i.target.checked)},children:A?"\u5F00\u542F":"\u5173\u95ED"})};O.default=function(){var u=T(),v=m()(u,1),A=v[0],K=(0,D.useState)({relation:"or",children:[{name:"123",sex:"1"}]}),I=m()(K,2),i=I[0],L=I[1];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,P.jsx)(f.Z,{form:A,onValuesChange:function(W,y){console.log(y),L(y)},children:(0,P.jsx)(f.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:i,required:!0,children:(0,P.jsx)(E.ZP,{fields:[{name:"name",rules:[{required:!0}],initialValue:"",render:function(){return(0,P.jsx)(h.Z,{style:{height:32}})}},{name:"check",render:function(){return(0,P.jsx)(t,{})}},{name:"sex",initialValue:"0",render:function(){return(0,P.jsxs)(c.Z,{children:[(0,P.jsx)(c.Z.Option,{value:"0",children:"\u7537"}),(0,P.jsx)(c.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(W){var y=W.isRoot;return(0,P.jsxs)(c.Z,{style:{width:80},bordered:y,children:[(0,P.jsx)(c.Z.Option,{value:"and",children:"and"}),(0,P.jsx)(c.Z.Option,{value:"or",children:"or"})]})},modifyTreeNode:function(){return{copyable:!0}}})})})}),(0,P.jsx)(j.ZP,{children:(0,P.jsx)(g.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(i),valueType:"jsonCode"})})]})}},65452:function(de,O,e){e.r(O);var B=e(97857),m=e.n(B),j=e(5574),g=e.n(j),f=e(46451),C=e(96365),h=e(34041),c=e(67294),D=e(91872),E=e(85893),P=f.Z.useForm;O.default=function(){var T=P(),t=g()(T,1),u=t[0],v=(0,c.useState)({relation:"or",children:[{name:"123",sex:"1"}]}),A=g()(v,2),K=A[0],I=A[1],i=(0,c.useRef)();return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,E.jsx)(f.Z,{form:u,onFinish:function(){i.current.validate()},onValuesChange:function(x,W){console.log(W),I(W)},children:(0,E.jsx)(f.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:K,required:!0,children:(0,E.jsx)(D.ZP,{actionRef:i,description:(0,E.jsx)("div",{style:{lineHeight:"32px"},children:"\u8FD9\u662F\u4E00\u4E2A\u989D\u5916\u7684 32px \u9AD8\u7684\u533A\u57DF"}),fields:[{name:"name",rules:[{required:!0}],initialValue:"",render:function(x){var W=x.getFieldError().length&&{borderColor:"red"};return(0,E.jsx)(C.Z,{style:m()({height:32},W)})}},{name:"sex",initialValue:"0",render:function(){return(0,E.jsxs)(h.Z,{children:[(0,E.jsx)(h.Z.Option,{value:"0",children:"\u7537"}),(0,E.jsx)(h.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(x){var W=x.isRoot;return(0,E.jsxs)(h.Z,{style:{width:80},bordered:W,children:[(0,E.jsx)(h.Z.Option,{value:"and",children:"and"}),(0,E.jsx)(h.Z.Option,{value:"or",children:"or"})]})}})})})})})}},44723:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(67294),h=e(91872),c=e(85893),D=j.Z.useForm;O.default=function(){var E=D(),P=m()(E,1),T=P[0];return(0,c.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,c.jsx)(j.Z,{form:T,onValuesChange:function(u,v){console.log(v)},children:(0,c.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"0"},{relation:"and",children:[{name:"lululu",sex:"1"}]}]},required:!0,children:(0,c.jsx)(h.ZP,{canAddRule:function(){return"hide"},canAddRuleGroup:function(){return!1},fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,c.jsx)(g.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(){return(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,c.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],modifyTreeNode:function(u){var v=u.namePath;return{copyable:!1,disabled:v.length>1}},modifyButton:function(u){var v=u.type;return{text:v==="add"?"haha":"xixi"}},relationRender:function(u){var v=u.isRoot;return(0,c.jsxs)(f.Z,{bordered:v,children:[(0,c.jsx)(f.Z.Option,{value:"and",children:"and"}),(0,c.jsx)(f.Z.Option,{value:"or",children:"or"})]})}})})})})}},24493:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(42075),h=e(71577),c=e(67294),D=e(91872),E=e(85893),P=j.Z.useForm;O.default=function(){var T=P(),t=m()(T,1),u=t[0],v=[{name:"fooooo",sex:"0"},{name:"bar",sex:"1"}];return(0,E.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,E.jsxs)(j.Z,{form:u,onFinish:function(){},onValuesChange:function(K,I){console.log(I)},children:[(0,E.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"1"}]},required:!0,children:(0,E.jsx)(D.ZP,{fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,E.jsx)(g.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(K){var I=K.getFieldValue("name");return I==="1024"?(0,E.jsx)("div",{children:"ho!!"}):(0,E.jsxs)(f.Z,{children:[(0,E.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,E.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],relation:(0,E.jsxs)(f.Z,{children:[(0,E.jsx)(f.Z.Option,{value:"and",children:"and"}),(0,E.jsx)(f.Z.Option,{value:"or",children:"or"})]}),text:{addRule:"Add Rule",addRelation:"Add Relation"},cascades:["name"],onCascade:function(K){console.log("onCascade"),K.setFieldValue("sex","1")},extraDragItemRender:function(K){return(0,E.jsx)("div",{children:(0,E.jsx)(C.Z,{direction:"vertical",children:v.map(function(I){return(0,E.jsxs)(C.Z,{children:["\u5916\u90E8\u6570\u636E:",K({data:I,onDragEnd:function(){console.log("end")},render:function(L){return(0,E.jsx)(h.ZP,{children:JSON.stringify(L)})}})]},JSON.stringify(I))})})})}})}),(0,E.jsx)(h.ZP,{htmlType:"submit",children:"\u63D0\u4EA4"})]})})}},60401:function(de,O,e){e.r(O);var B=e(15009),m=e.n(B),j=e(99289),g=e.n(j),f=e(5574),C=e.n(f),h=e(46451),c=e(96365),D=e(34041),E=e(71577),P=e(67294),T=e(91872),t=e(85893),u=h.Z.useForm;O.default=function(){var v=u(),A=C()(v,1),K=A[0],I=(0,P.useRef)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,t.jsxs)(h.Z,{form:K,onFinish:g()(m()().mark(function i(){return m()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,I.current.validate();case 3:x.next=9;break;case 5:x.prev=5,x.t0=x.catch(0),console.log(x.t0),I.current.reRender();case 9:case"end":return x.stop()}},i,null,[[0,5]])})),onValuesChange:function(L,x){console.log("onValuesChange",x)},children:[(0,t.jsx)(h.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"and",children:[{name:"\u5220\u6389\u6211",sex:"0"}]},required:!0,children:(0,t.jsx)(T.ZP,{actionRef:I,fields:[{name:"name",rules:[{required:!0,message:"\u5FC5\u586B\u9879\uFF01"}],initialValue:"",render:function(){return(0,t.jsx)(c.Z,{})}},{name:"sex",initialValue:"0",render:function(L){var x=L.getFieldValue("name");return x==="1024"?(0,t.jsx)("div",{children:"ho!!"}):(0,t.jsxs)(D.Z,{children:[(0,t.jsx)(D.Z.Option,{value:"0",children:"\u7537"}),(0,t.jsx)(D.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(L){var x=L.isRoot;return(0,t.jsxs)(D.Z,{bordered:x,style:{width:60},children:[(0,t.jsx)(D.Z.Option,{value:"and",children:"and"}),(0,t.jsx)(D.Z.Option,{value:"or",children:"or"})]})}})}),(0,t.jsx)(E.ZP,{htmlType:"submit",children:"\u63D0\u4EA4"})]})})})}},85682:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(67294),h=e(91872),c=e(85893),D=j.Z.useForm;O.default=function(){var E=D(),P=m()(E,1),T=P[0];return(0,c.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,c.jsx)(j.Z,{form:T,onValuesChange:function(u,v){console.log(v)},children:(0,c.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"0"},{relation:"and",children:[{name:"lululu",sex:"1"}]}]},required:!0,children:(0,c.jsx)(h.ZP,{fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,c.jsx)(g.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(){return(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,c.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(u){var v=u.isRoot;return v?(0,c.jsx)("div",{children:"\u6839\u8282\u70B9"}):(0,c.jsxs)("select",{children:[(0,c.jsx)("option",{value:"and",children:"and"}),(0,c.jsx)("option",{value:"or",children:"or"})]})},canAddRule:function(u){return u.depth!==2}})})})})}},40418:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(67294),h=e(91872),c=e(85893),D=j.Z.useForm;O.default=function(){var E=D(),P=m()(E,1),T=P[0];return(0,c.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,c.jsx)(j.Z,{form:T,onValuesChange:function(u,v){console.log(v)},children:(0,c.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"0"},{relation:"and",children:[{name:"lululu",sex:"1"}]}]},required:!0,children:(0,c.jsx)(h.ZP,{canAddRule:function(){return"hide"},canAddRuleGroup:function(){return!1},fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,c.jsx)(g.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(){return(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,c.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],modifyButton:function(u){var v=u.type;return{text:v==="add"?"haha":"xixi",disabled:v==="add"}},relationRender:function(u){var v=u.isRoot;return(0,c.jsxs)(f.Z,{bordered:v,children:[(0,c.jsx)(f.Z.Option,{value:"and",children:"and"}),(0,c.jsx)(f.Z.Option,{value:"or",children:"or"})]})}})})})})}},37799:function(de,O,e){e.r(O);var B=e(96365),m=e(34041),j=e(91872),g=e(85893);O.default=function(){return(0,g.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,g.jsx)(j.ZP,{defaultValue:{relation:"and",children:[{name:"\u4E0D\u70AB\u9177\u4E86"},{name:"\u6CA1\u7075\u9B42\u4E86"}]},onChange:function(C){console.log(C)},fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,g.jsx)(B.Z,{style:{height:32}})}}],modifyTreeNode:function(){return{draggable:!1}},relationRender:function(C){var h=C.isRoot;return(0,g.jsxs)(m.Z,{bordered:h,children:[(0,g.jsx)(m.Z.Option,{value:"and",children:"and"}),(0,g.jsx)(m.Z.Option,{value:"or",children:"or"})]})}})})}},48014:function(de,O,e){e.r(O);var B=e(97857),m=e.n(B),j=e(5574),g=e.n(j),f=e(52074),C=e(16855),h=e(46451),c=e(84567),D=e(96365),E=e(34041),P=e(42075),T=e(71577),t=e(67294),u=e(91872),v=e(85893),A=h.Z.useForm,K=function(i){var L=i.value,x=i.onChange;return(0,v.jsx)(c.Z,{checked:L,onChange:function(y){x(y.target.checked)},children:L?"\u5F00\u542F":"\u5173\u95ED"})};O.default=function(){var I=A(),i=g()(I,1),L=i[0],x=(0,t.useState)({relation:"or",children:[{name:"123",sex:"1"}]}),W=g()(x,2),y=W[0],ne=W[1],ue=function(){var ae={rule:{relation:"or",children:[{name:"123",sex:"0"},{relation:"and",children:[{name:"new name",sex:"1"}]}]}};L.setFieldsValue(ae),ne(ae)},re=(0,t.useRef)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,v.jsxs)(h.Z,{form:L,onFinish:function(){re.current.validate()},onValuesChange:function(ae,fe){console.log(fe),ne(fe)},children:[(0,v.jsx)(h.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:y,required:!0,children:(0,v.jsx)(u.ZP,{actionRef:re,fields:[{name:"name",rules:[{required:!0}],initialValue:"",render:function(ae){var fe=ae.getFieldError().length&&{borderColor:"red"};return(0,v.jsx)(D.Z,{style:m()({height:32},fe)})}},{name:"check",render:function(){return(0,v.jsx)(K,{})}},{name:"sex",initialValue:"0",render:function(ae){var fe=ae.getFieldValue("name"),je=ae.getFieldValue("check");return fe==="1024"?(0,v.jsx)("div",{children:"ho!!"}):je?(0,v.jsxs)(E.Z,{children:[(0,v.jsx)(E.Z.Option,{value:"0",children:"\u7537"}),(0,v.jsx)(E.Z.Option,{value:"1",children:"\u5973"})]}):!1}}],relationRender:function(ae){var fe=ae.isRoot;return(0,v.jsxs)(E.Z,{bordered:fe,style:{width:80},children:[(0,v.jsx)(E.Z.Option,{value:"and",children:"and"}),(0,v.jsx)(E.Z.Option,{value:"or",children:"or"})]})},cascades:["name"],onCascade:function(ae){console.log("onCascade"),ae.setFieldValue("sex","1")}})}),(0,v.jsxs)(P.Z,{children:[(0,v.jsx)(T.ZP,{onClick:ue,children:"\u4FEE\u6539\u503C"}),(0,v.jsx)(T.ZP,{htmlType:"submit",children:"\u63D0\u4EA4"})]})]})}),(0,v.jsx)(f.ZP,{children:(0,v.jsx)(C.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(y),valueType:"jsonCode"})})]})}},87898:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(97857),g=e.n(j),f=e(16855),C=e(46451),h=e(83062),c=e(96365),D=e(34041),E=e(71577),P=e(5914),T=e(67294),t=e(91872),u=e(85893),v=C.Z.useForm,A=function(I){var i=I.value,L=I.onChange,x=I.ctx,W=I.errorStyle;return(0,u.jsx)(h.Z,{color:"red",title:x.getFieldError()[0],visible:!!x.getFieldError().length,children:(0,u.jsx)(c.Z,{value:i,onChange:L,style:g()({height:32},W)})})};O.default=function(){var K=v(),I=m()(K,1),i=I[0],L=(0,T.useRef)(),x=(0,T.useState)(null),W=m()(x,2),y=W[0],ne=W[1],ue=(0,T.useState)(),re=m()(ue,2),w=re[0],ae=re[1],fe=v(),je=m()(fe,1),se=je[0],$=(0,T.useState)(!1),Ee=m()($,2),pe=Ee[0],De=Ee[1];return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:[(0,u.jsxs)(C.Z,{form:i,onValuesChange:function(oe,Oe){console.log("onValuesChange",Oe)},children:[(0,u.jsx)(C.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"and"},required:!0,children:(0,u.jsx)(t.ZP,{actionRef:L,onFieldFocus:function(oe,Oe,Pe,q){ne(oe),ae(q),De(!0)},fields:[{name:"name",rules:[{required:!0,message:"\u5FC5\u586B\u9879\uFF01"}],initialValue:"",render:function(oe){var Oe=oe.getFieldError().length&&{borderColor:"red",outline:"none"};return(0,u.jsx)(A,{errorStyle:Oe,ctx:oe})}},{name:"sex",initialValue:"0",render:function(oe){var Oe=oe.getFieldValue("name");return Oe==="1024"?(0,u.jsx)("div",{children:"ho!!"}):(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(D.Z.Option,{value:"0",children:"\u7537"}),(0,u.jsx)(D.Z.Option,{value:"1",children:"\u5973"})]})}}],relation:(0,u.jsxs)(D.Z,{style:{width:60},children:[(0,u.jsx)(D.Z.Option,{value:"and",children:"and"}),(0,u.jsx)(D.Z.Option,{value:"or",children:"or"})]})})}),(0,u.jsx)(E.ZP,{htmlType:"submit",children:"\u63D0\u4EA4"})]}),(0,u.jsxs)(P.Z,{visible:pe,onOk:function(){se.validateFields().then(function(oe){L.current.setData(y,oe),De(!1)})},onCancel:function(){De(!1)},title:"\u590D\u6742\u7684\u7F16\u8F91\u6D41\u7A0B",children:["\u5173\u6CE8\u7684\u8282\u70B9\uFF1A",(0,u.jsx)(f.ZP,{mode:"read",valueType:"jsonCode",value:JSON.stringify(w)}),"key\u4E3A\uFF1A",y,(0,u.jsxs)(C.Z,{form:se,children:[(0,u.jsx)(C.Z.Item,{name:"name",label:"\u5916\u90E8\u7F16\u8F91name",children:(0,u.jsx)(c.Z,{})}),(0,u.jsx)(C.Z.Item,{name:"sex",label:"\u5916\u90E8\u7F16\u8F91label",children:(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(D.Z.Option,{value:"0",children:"\u7537"}),(0,u.jsx)(D.Z.Option,{value:"1",children:"\u5973"})]})})]})]})]})})}},53906:function(de,O,e){e.r(O),e.d(O,{default:function(){return fe},initRuleData:function(){return ue}});var B=e(15009),m=e.n(B),j=e(99289),g=e.n(j),f=e(5574),C=e.n(f),h=e(97857),c=e.n(h),D=e(19632),E=e.n(D),P=e(47389),T=e(82061),t=e(46451),u=e(42075),v=e(71577),A=e(85265),K=e(96365),I=e(86738),i=e(96486),L=e.n(i),x=e(67294),W=e(91872),y=e(85893),ne=[{value:"name",label:"\u540D\u79F0"},{value:"section",label:"\u79D1"},{value:"family",label:"\u5C5E"}],ue=[{name:"\u8C79",section:"\u8C79\u4E9A\u79D1",family:"\u5927\u578B\u732B\u79D1",children:[{name:"\u96EA\u8C79",section:"\u8C79\u79D1",family:"\u8C79\u5C5E"}]},{name:"\u732B",section:"\u732B\u4E9A\u79D1",family:"\u5C0F\u578B\u732B\u79D1"}],re=function je(se){return se==null?void 0:se.map(function($){var Ee=$.name,pe=$.section,De=$.family,te=$.children,oe={};return te&&te.length&&(oe.children=je(E()(te)),oe.relation={name:Ee,section:pe,family:De}),c()({node:{name:Ee,section:pe,family:De}},oe)})},w=function(se){var $=se.value,Ee=se.onChange,pe=t.Z.useForm(),De=C()(pe,1),te=De[0],oe=(0,x.useState)(!1),Oe=C()(oe,2),Pe=Oe[0],q=Oe[1],ve=$||{},ce=ve.name,Ae=ce===void 0?"\u540D\u79F0":ce,Ie=ve.section,Ue=Ie===void 0?"\u79D1":Ie,Le=ve.family,xe=Le===void 0?"\u5C5E":Le,We=function(){te.validateFields().then(function(Ne){Ee(Ne),te.resetFields(),q(!1)})},Ve=(0,y.jsxs)(u.Z,{children:[(0,y.jsx)(v.ZP,{onClick:function(){te.resetFields(),q(!1)},children:"\u53D6\u6D88"}),(0,y.jsx)(v.ZP,{type:"primary",onClick:We,children:"\u786E\u5B9A"})]});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(u.Z,{align:"baseline",style:{whiteSpace:"nowrap"},children:[Ae,"\u3001",Ue,"\u3001",xe,(0,y.jsx)(P.Z,{onClick:function(){te.setFieldsValue($),q(!0)}})]}),Pe?(0,y.jsx)(A.Z,{open:Pe,destroyOnClose:!0,width:"600px",onClose:function(){te.resetFields(),q(!1)},extra:Ve,title:"\u7F16\u8F91",children:(0,y.jsx)(t.Z,{form:te,labelCol:{span:4},children:ne.map(function(Ze){return(0,y.jsx)(t.Z.Item,{name:Ze.value,label:Ze.label,rules:[{required:!0}],children:(0,y.jsx)(K.Z,{})},Ze.value)})})}):null]})},ae=function(se){var $=se.value,Ee=se.onChange;return(0,y.jsx)("div",{className:"relation-node",style:{whiteSpace:"nowrap"},children:$!=null&&$.isRoot?(0,y.jsx)("span",{children:$==null?void 0:$.name}):(0,y.jsx)(w,{value:$,onChange:Ee,editNodeFields:ne})})};function fe(){var je=(0,x.useRef)(),se={relation:{name:"\u732B\u79D1\u7269\u79CD",isRoot:!0},children:re(ue)},$=(0,x.useState)(se),Ee=C()($,2),pe=Ee[0],De=Ee[1],te=function Pe(q,ve){var ce=L().cloneDeep(q);if(ve&&ve.length===1)return L().remove(ce,function(Ue,Le){return Number(ve[0])!==Le});var Ae=ve.shift(),Ie=ce[Ae].children;return ce[Ae].children=Pe(Ie,ve),ce},oe=function(){var Pe=g()(m()().mark(function q(ve){var ce,Ae,Ie,Ue,Le;return m()().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:ce=pe||{},Ae=ce.children,Ie=Ae===void 0?[]:Ae,Ue=ve.namePath,Le=te(Ie,Ue),De(c()(c()({},se),{},{children:Le}));case 4:case"end":return We.stop()}},q)}));return function(ve){return Pe.apply(this,arguments)}}(),Oe=function(q){return{remove:(0,y.jsx)(u.Z,{size:6,children:(0,y.jsx)(I.Z,{title:"\u786E\u5B9A\u5220\u9664\u8BE5\u6761\u6570\u636E\u4EE5\u53CA\u5B50\u6570\u636E",onConfirm:function(){oe(q)},children:(0,y.jsx)(T.Z,{})})})}};return(0,y.jsx)(W.ZP,{actionRef:je,value:pe,style:{overflowY:"auto"},fields:[{name:"node",render:function(){return(0,y.jsx)(w,{editNodeFields:ne})}}],onChange:function(q){return De(q)},relationRender:function(){return(0,y.jsx)(ae,{})},actionsRender:Oe,id:"rule",modifyTreeNode:function(){return{removable:!0}}})}},22129:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(16855),g=e(46451),f=e(55241),C=e(96365),h=e(34041),c=e(67294),D=e(91872),E=e(2903),P=e(85893),T=g.Z.useForm,t=function(v){return(0,P.jsx)(f.Z,{title:(0,P.jsx)(C.Z,{value:v.value,onChange:function(K){v.onChange(K.target.value)}}),children:v.value})};O.default=function(){var u=T(),v=m()(u,1),A=v[0],K=(0,c.useState)({relation:"and",children:[{name:"1"},{relation:"and",children:[{name:"2"}]}]}),I=m()(K,2),i=I[0],L=I[1];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,P.jsx)(g.Z,{form:A,onValuesChange:function(W,y){console.log(y),L(y.rule)},children:(0,P.jsx)(g.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:i,required:!0,children:(0,P.jsx)(D.ZP,{fields:[{name:"name",rules:[{required:!0}],initialValue:"1",render:function(){return(0,P.jsx)(t,{})}}],modifyTreeNode:function(W){var y=W.type;return{className:y==="FIELD"?"black":"",removable:y==="RELATION"}},relationRender:function(W){var y=W.isRoot;return(0,P.jsxs)(h.Z,{style:{width:72},bordered:y,children:[(0,P.jsx)(h.Z.Option,{value:"and",children:"AND"}),(0,P.jsx)(h.Z.Option,{value:"or",children:"OR"})]})}})})})}),(0,P.jsx)(j.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(i),valueType:"jsonCode"})]})}},25269:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(16855),g=e(96365),f=e(34041),C=e(67294),h=e(91872),c=e(2903),D=e(85893);O.default=function(){var E=(0,C.useRef)(),P=(0,C.useState)({relation:"and",collapse:!1,children:[{name:"1"},{relation:"or",children:[{relation:"and",name:"1"},{relation:"and",collapse:!1,children:[{name:"1"}]},{relation:"and",collapse:!1,children:[{name:"1"}]}]}]}),T=m()(P,2),t=T[0],u=T[1];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,D.jsx)(h.ZP,{onChange:function(A){u(A)},actionRef:E,fields:[{name:"name",rules:[{required:!0}],initialValue:"1",render:function(){return(0,D.jsx)(g.Z,{})}}],defaultValue:t,modifyTreeNode:function(){return{removable:!0}},relationRender:function(A){var K=A.isRoot;return(0,D.jsxs)(f.Z,{bordered:K,style:{width:72},children:[(0,D.jsx)(f.Z.Option,{value:"and",children:"AND"}),(0,D.jsx)(f.Z.Option,{value:"or",children:"OR"})]})}})}),(0,D.jsx)("button",{onClick:function(){return E.current.reRender()},children:"re render"}),(0,D.jsx)(j.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(t),valueType:"jsonCode"})]})}},60694:function(de,O,e){e.r(O);var B=e(5574),m=e.n(B),j=e(46451),g=e(96365),f=e(34041),C=e(91872),h=e(85893),c=j.Z.useForm;O.default=function(){var D=c(),E=m()(D,1),P=E[0];return(0,h.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,h.jsx)(j.Z,{form:P,onValuesChange:function(t,u){console.log(u)},children:(0,h.jsx)(j.Z.Item,{label:"\u89C4\u5219\u6811",name:"rule",initialValue:{relation:"or",children:[{name:"123",sex:"0"}]},required:!0,children:(0,h.jsx)(C.ZP,{fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,h.jsx)(g.Z,{style:{height:32}})}},{name:"name1",rules:[{required:!0}],render:function(){return(0,h.jsx)(g.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(t){var u=t.getFieldValue("name");return u==="love"?(0,h.jsx)("div",{children:"is just a lie."}):(0,h.jsxs)(f.Z,{children:[(0,h.jsx)(f.Z.Option,{value:"0",children:"\u7537"}),(0,h.jsx)(f.Z.Option,{value:"1",children:"\u5973"})]})}}],cascades:["name","name1"],onCascade:function(t,u){console.log(u),t.setFieldValue("sex","1")},relationRender:function(t){var u=t.isRoot;return(0,h.jsxs)(f.Z,{bordered:u,children:[(0,h.jsx)(f.Z.Option,{value:"and",children:"and"}),(0,h.jsx)(f.Z.Option,{value:"or",children:"or"})]})}})})})})}},85911:function(de,O,e){e.r(O);var B=e(97857),m=e.n(B),j=e(5574),g=e.n(j),f=e(16855),C=e(46451),h=e(96365),c=e(34041),D=e(71577),E=e(67294),P=e(91872),T=e(2903),t=e(85893),u=C.Z.List,v=C.Z.useForm;O.default=function(){var A=v(),K=g()(A,1),I=K[0],i=(0,E.useState)({relation:"and"}),L=g()(i,2),x=L[0],W=L[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,t.jsx)(C.Z,{form:I,onValuesChange:function(ne,ue){console.log(ue),W(ue)},children:(0,t.jsx)(u,{name:"form-list",initialValue:[x],children:function(ne,ue){var re=ue.add;return console.log(ne),(0,t.jsxs)(t.Fragment,{children:[ne.map(function(w){return console.log(ne),(0,E.createElement)(C.Z.Item,m()(m()({},w),{},{key:w.key}),(0,t.jsx)(P.ZP,{fields:[{name:"test",render:function(){return(0,t.jsx)(h.Z,{})}}],relationRender:(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(c.Z.Option,{value:"and",children:"and"}),(0,t.jsx)(c.Z.Option,{value:"or",children:"or"})]})}))}),(0,t.jsx)("div",{children:(0,t.jsx)(D.ZP,{onClick:function(){return re({relation:"and"})},children:"\u6DFB\u52A0\u4E00\u9879"})})]})}})})}),(0,t.jsx)(f.ZP,{fieldProps:{style:{width:"100%"}},mode:"read",text:JSON.stringify(x),valueType:"jsonCode"})]})}},87714:function(de,O,e){e.r(O);var B=e(96365),m=e(34041),j=e(91872),g=e(85893);O.default=function(){return(0,g.jsx)("div",{style:{padding:"20px 50px",backgroundColor:"white"},children:(0,g.jsx)(j.ZP,{defaultValue:{relation:"and"},onChange:function(C){console.log(C)},fields:[{name:"name",rules:[{required:!0}],render:function(){return(0,g.jsx)(B.Z,{style:{height:32}})}},{name:"sex",initialValue:"0",render:function(){return(0,g.jsxs)(m.Z,{children:[(0,g.jsx)(m.Z.Option,{value:"0",children:"\u7537"}),(0,g.jsx)(m.Z.Option,{value:"1",children:"\u5973"})]})}}],relationRender:function(C){var h=C.isRoot;return(0,g.jsxs)(m.Z,{bordered:h,children:[(0,g.jsx)(m.Z.Option,{value:"and",children:"and"}),(0,g.jsx)(m.Z.Option,{value:"or",children:"or"})]})}})})}},91872:function(de,O,e){e.d(O,{ZP:function(){return On}});var B=e(97857),m=e.n(B),j=e(9783),g=e.n(j),f=e(5574),C=e.n(f),h=e(67294),c=e(12444),D=e.n(c),E=e(72004),P=e.n(E),T=e(96486),t=e.n(T),u=function(){function F(r,a){var l=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3?arguments[3]:void 0;D()(this,F),g()(this,"root",void 0),g()(this,"nodes",[]),g()(this,"key",0),g()(this,"collapsible",!1),g()(this,"getCurrentMap",function(){var s=l.getPureData(),d=[],p=function M(Z,R){var b=Object.keys(Z).join("-");d[R]||(d[R]=""),d[R]+="".concat(b,"_"),Z.children&&Array.isArray(Z.children)&&Z.children.forEach(function(U){M(U,R+1)})};return p(s,0),d.join("/")}),this.root=this.createNode(r,a,!1,n),this.nodes.push(this.root),this.collapsible=o}return P()(F,[{key:"isRoot",value:function(a){return a===this.root}},{key:"getRoot",value:function(){return this.root}},{key:"toggleCollapse",value:function(a){var l=this.findByKey(a);l.collapse=!l.collapse}},{key:"shouldCollapse",value:function(a){for(var l=this.findByKey(a),o=l.collapse,n=l;n.parent;){if(n.parent.collapse){o=!0;break}n=n.parent}return o}},{key:"createNode",value:function(a,l){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.key+=1,{data:a,parent:void 0,children:void 0,key:this.key-1,depth:this.root?NaN:0,height:NaN,type:l,namePath:[],collapse:o,preserveData:n}}},{key:"dfs",value:function(a,l){var o=this;a.children&&a.children.forEach(function(n){o.dfs(n,l),l(n)}),l(a)}},{key:"bfs",value:function(a,l){var o=this;l(a),a.children&&a.children.forEach(function(n){o.bfs(n,l)})}},{key:"find",value:function(a,l){var o;return this.bfs(this.root,function(n){n[a]===l&&(o=n)}),o}},{key:"findByKey",value:function(a){return this.nodes.find(function(l){return l.key===a})}},{key:"appendToRoot",value:function(a){var l=this.root.key;this.appendByKey(l,a)}},{key:"appendByKey",value:function(a,l,o){var n=this,s=this.find("key",a);return s?(s.children||(s.children=[]),Object.assign(l,{parent:s}),Object.assign(l,{depth:s.depth+1}),l.children&&this.bfs(l,function(d){d!==l&&(n.nodes.push(d),Object.assign(d,{depth:d.parent.depth+1}))}),o!=null&&o.toString()?s.children.splice(o,0,l):s.children.push(l),Object.assign(l,{namePath:s.namePath.slice().concat(t().indexOf(s.children,l).toString())}),this.nodes.push(l),this.root):!1}},{key:"removeByKey",value:function(a){var l,o=this.find("key",a);if(!o)return l;var n=o.parent;if(n.children.forEach(function(d,p){d.key===a&&(l=n.children.splice(p,1))}),!l)throw new Error("cant found removed root");var s=[];return this.bfs(l[0],function(d){s.push(d.key)}),this.nodes=this.nodes.filter(function(d){return!s.includes(d.key)}),l}},{key:"move",value:function(a,l,o){var n=this.removeByKey(a);if(!n)return!1;var s=this.appendByKey(l,n[0],o);return!!s}},{key:"render",value:function(){for(var a=this,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];o.forEach(function(s){var d=s.order,p=s.renderFunction;d==="dfs"?a.dfs(a.root,p):a.bfs(a.root,p)})}},{key:"getChildrenData",value:function(a){var l=this,o=function n(s){var d={},p=s.data,M=s.children,Z=s.collapse,R=s.type,b=s.preserveData;if(Object.assign(d,p),Object.assign(d,b),R==="RELATION"&&l.collapsible&&Object.assign(d,{collapse:Z}),M){var U=[];M.forEach(function(z){U.push(n(z))}),Object.assign(d,{children:U})}return d};return o(a)}},{key:"getPureData",value:function(){return this.getChildrenData(this.root)}},{key:"getMaxLeft",value:function(){for(var a=this.nodes,l=0,o=0;o<a.length;o++){var n=a[o];(!l||n.position.x>l)&&(l=n.position.x)}return l}}],[{key:"initWithData",value:function(a,l,o){var n=a;if(!a)throw new Error("\u65E0\u6570\u636E\u6216\u6570\u636E\u975E\u5BF9\u8C61\uFF0C\u8BF7\u4F7F\u7528 FormItem.initialValue | FormInstance.setFiledValue | defaultValue \u7B49\u65B9\u5F0F\u521D\u59CB\u5316\u6570\u636E\uFF0C\u5F53\u524D\u503C\u4E3A ".concat(a));if(!n.hasOwnProperty("relation"))throw new Error(`\u6570\u636E\u5FC5\u987B\u5305\u542B relation \u5B57\u6BB5\uFF0C\u4F8B\u5982 { relation: "and" }\uFF0C\u5F53\u524D\u6570\u636E\u4E3A\uFF1A
`.concat(JSON.stringify(a,void 0,2)));var s=t().omit(n,["relation","children"]),d=new F({relation:n.relation},"RELATION",l,s),p=function M(Z,R){var b=R.children;b==null||b.forEach(function(U){var z=U.hasOwnProperty("relation"),le=null;if(z){var _e=t().omit(U,["relation","children"]),J=t().pick(U,["relation"]);le=d.createNode(m()({},J),"RELATION",U.collapse,_e)}else{var Y=t().omit(U,o),ie=t().pick(U,o);le=d.createNode(m()({},ie),"FIELD",U.collapse,Y)}d.appendByKey(Z,le),U.children&&M(le.key,U)})};return p(d.getRoot().key,n),t().cloneDeep(d)}}]),F}();g()(u,"getNewInstance",function(F){return t().cloneDeep(F)});var v=e(60869),A=e(70129),K=e(63679),I=e(36963),i=e(85893),L=function(r){var a=r.children,l=r.noDndProvider;return l?(0,i.jsx)(i.Fragment,{children:a}):(0,i.jsx)(K.W,{backend:I.PD,children:a})},x="RELATION",W="FIELD",y="PLACEMENT",ne=10,ue=56,re="rule-tree",w=e(19632),ae=e.n(w),fe=e(52677),je=e.n(fe),se=function(r){var a={},l=function o(n,s){if(n.relation){var d;a[(s?"".concat(s,"."):"")+"relation"]=n.relation,(d=n.children)===null||d===void 0||d.forEach(function(Z,R){o(Z,(s?"".concat(s,"."):"")+"children."+R)})}else for(var p in n)if(n.hasOwnProperty(p)){var M=n[p];a[(s?"".concat(s,"."):"")+p]=je()(M)==="object"?t().cloneDeep(M):M}};return l(r,""),a},$=function(r){return["0"].concat(ae()(r)).join("-")},Ee=function(r){var a=document.querySelector("#svg-drag"),l=document.querySelector(".rule-tree"),o=window.getComputedStyle(l);a.style.height=o.height,a.style.width=o.width,a.innerHTML=r.map(function(n){var s=(n.fromX+n.toX)/2+.5;return'<path id="'.concat(n.id,'" d="M').concat(n.fromX,",").concat(n.fromY," L").concat(s,",").concat(n.fromY," M").concat(s,",").concat(n.fromY," L").concat(s,",").concat(n.toY," M").concat(s,",").concat(n.toY," L").concat(n.toX,",").concat(n.toY,'" stroke="#1890ff" fill="none" style="stroke-width: 0;"></path>')}).join("")},pe=function(r){var a=[],l=document.querySelector(".rule-tree").getClientRects()[0],o=function n(s){var d;if(s!=null&&s[0]){var p=(d=s[0])===null||d===void 0?void 0:d.parent,M=$(p.namePath),Z=document.querySelector(".id-".concat(M," .relation")).getClientRects();t().forEach(document.querySelectorAll(".dp-id-".concat($(p.namePath))),function(R){var b=R.getClientRects(),U=R.getAttribute("data-order");a.push({fromX:Z[0].left+Z[0].width-l.left,fromY:Z[0].top+Z[0].height/2-l.top,toX:b[0].left-l.left,toY:b[0].top+b[0].height/2-l.top,id:"f-".concat($(p.namePath),"-o-").concat(U)})}),s.forEach(function(R){R.type==="RELATION"&&n(R.children)})}};o(r.getRoot().children),Ee(a)},De=function(r,a){var l=se(a);Object.keys(l).forEach(function(o){var n=o.split(".").filter(function(d){return d!=="children"});if(n.join("")){var s=n;n.length>2&&(s=[n.slice(0,-1).join(".")].concat(n[n.length-1])),r.setFields([{name:s,value:l[o]}])}})},te=function(){(0,h.useEffect)(function(){var r=document.querySelectorAll(".relation-children");r.forEach(function(a){var l=t().find(a.children,function(s){return s.className.includes("relation-line")});if(l){var o=a.children[2];if(o){var n=parseFloat(window.getComputedStyle(o).height);l.setAttribute("style","height: calc(100% - ".concat(n/2+40-ne,"px); top: ").concat(n/2-ne+26,"px;"))}}})})},oe=e(25098),Oe=e.n(oe),Pe=e(31996),q=e.n(Pe),ve=e(26037),ce=e.n(ve),Ae=e(18689),Ie=e(35038),Ue=e(51329),Le=e(94184),xe=e.n(Le),We=e(98958),Ve=function(r){var a=r.children;return(0,i.jsx)("div",{style:{display:"flex",height:"100%",rowGap:8,columnGap:8},children:a.filter(function(l){return!!l}).map(function(l,o){var n,s,d,p=!!(l!=null&&(n=l.props)!==null&&n!==void 0&&(s=n.children)!==null&&s!==void 0&&(d=s.props)!==null&&d!==void 0&&d.__should_not_render__);return(0,i.jsx)("div",{style:{display:p?"none":"flex",alignItems:"center",gap:8},children:l},o)})})},Ze=e(98169),Ne="TREE_NODE",Ge=function(r){var a=r.relatedKeys,l=r.children,o=r.parentKey,n=r.order,s=r.parentNamePath,d=s.slice().concat("".concat(n)),p=(0,Ze.L)(function(){return{accept:Ne,collect:function(Y){return{isOver:Y.isOver(),canDrop:(Y.getItemType()===Ne,Y.canDrop())}},canDrop:function(Y){var ie=Y.from;return ie==="internal"?!(d&&Y.namePath&&d.join(".").startsWith(Y.namePath.join("."))||a.includes(Y.thisKey)):!0},drop:function(Y){return m()(m()({},Y),{},{parentKey:o,originOrder:n,order:Y.currentIndex<n?n-1:n})}}},[a,o,d]),M=C()(p,2),Z=M[0],R=Z.canDrop,b=Z.isOver,U=M[1],z="";b?z=R?"rgb(24,144,255)":"red":z="rgb(145,213,255)";var le="#f-".concat($(s),"-o-").concat(n),_e=document.querySelector(le);return _e&&(_e.style.strokeWidth=R?"1":"0"),(0,i.jsx)("div",{ref:U,style:{backgroundColor:z,opacity:R?1:0},className:xe()("drop-placement","dp-id-".concat($(s))),"data-order":n,"data-p":o,"data-r":a.join(","),"data-namepath":d.join(","),children:l})},Je=function(r){var a=r.children,l=r.disabled,o=r.thisKey,n=r.namePath,s=r.onMove,d=r.dragger,p=r.nodeType,M=r.currentIndex,Z=r.rowConfig,R=(0,We.c)(function(){return{type:Ne,item:{thisKey:o,namePath:n,from:"internal",currentIndex:M},collect:function(J){return{isDragging:J.isDragging()}},end:function(J,Y){var ie=Y.getDropResult();if(ie&&J.from==="internal"){var Q=ie,Ce=Q.parentKey,ye=Q.order,Me=Q.originOrder;s(o,Ce,ye,Me)}},canDrag:!l}},[o,n]),b=C()(R,3),U=b[0].isDragging,z=b[1],le=b[2];return(0,i.jsx)("div",{ref:le,style:{opacity:U?.5:1},"data-thiskey":o,"data-namepath":n,children:(0,i.jsx)("div",{className:xe()(Z.className,"drag-container","drag-container-".concat(p.toLowerCase())),children:(0,i.jsxs)(Ve,{children:[Z.draggable&&(0,i.jsx)("div",{ref:z,children:d}),(0,i.jsx)(i.Fragment,{children:a})]})})})},Bn=function(r){var a=r.data,l=r.onDrop,o=r.disabled,n=r.children,s=useDrag(function(){return{type:TYPE,item:{data:a,from:"external"},collect:function(b){return{isDragging:b.isDragging()}},end:function(b,U){var z=U.getDropResult();z&&l(_.cloneDeep(b.data),z.parentKey,z.order)},canDrag:!o}}),d=_slicedToArray(s,3),p=d[0].isDragging,M=d[1],Z=d[2];return _jsx("div",{ref:Z,style:{opacity:p?"0.5":1},children:_jsx("div",{ref:M,children:n})})},nn=function(F){q()(a,F);var r=ce()(a);function a(){return D()(this,a),r.apply(this,arguments)}return P()(a,[{key:"shouldComponentUpdate",value:function(o){return!0}},{key:"render",value:function(){var o=this.props,n=o.children,s=o.value,d=o.onChange,p=o.rowConfig,M=o.fieldError,Z=o.namePath;return h.cloneElement(n,m()(m()(m()(m()({},n.props),{value:s,onChange:d}),{disabled:p.disabled,fieldError:M,status:M.length>0?"error":void 0}),{},{key:"field-component-".concat(Z.join("-"))}))}}]),a}(h.Component),rn=function(F){q()(a,F);var r=ce()(a);function a(){var l;D()(this,a);for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return l=r.call.apply(r,[this].concat(n)),g()(Oe()(l),"getNamePath",function(){var d=l.props,p=d.currentNode,M=d.name,Z=[p.namePath.join(".")].concat(M);return Z}),l}return P()(a,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var o=this.props,n=o.form,s=o.currentKey,d=o.currentNode,p=o.indexParams,M=o.render,Z=o.rules,R=o.onCascade,b=o.cascades,U=o.name,z=o.rowConfig,le=this.getNamePath(),_e={getFieldError:function(){return n.getFieldError(le)},getFieldValue:function(Q){return n.getFieldValue([d.namePath.join(".")].concat(Q))},setFieldValue:function(Q,Ce){n.setFields([{name:[d.namePath.join(".")].concat(Q),value:Ce}])}},J=M(_e,d,{index:p.index,length:p.length}),Y=h.isValidElement(J);return J===!1?J:Y?(0,i.jsx)("div",{children:(0,i.jsx)(A.ZP.Field,{name:le,rules:Z,children:function(Q){var Ce=function(ge){var ee;if((ee=Q.onChange)===null||ee===void 0||ee.call(Q,ge),R&&b!==null&&b!==void 0&&b.includes(U)){var G;R(_e,U),(G=Q.onChange)===null||G===void 0||G.call(Q,ge)}},ye=n.getFieldError(le);return(0,i.jsx)(nn,{value:Q.value,namePath:le,onChange:Ce,fieldError:ye,rowConfig:z,children:J})}},"field-".concat(s,"-").concat(U))}):(console.error("\u9519\u8BEF\u7684 field \u6E32\u67D3\uFF0C\u8BF7\u4F7F\u7528 React.FC<{value:any;onChange:any}> \u7C7B\u578B\u4F5C\u4E3A field \u7684 render \u8FD4\u56DE\u503C"),J)}}]),a}(h.Component),tn=function(F){q()(a,F);var r=ce()(a);function a(){return D()(this,a),r.apply(this,arguments)}return P()(a,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var o=this.props,n=o.rowConfig,s=o.handleCopy,d=o.handleRemove,p=o.currentKey,M=o.currentNode,Z=o.actionsRender,R=o.indexParams,b=o.onMove,U=o.fields,z=o.form,le=o.cascades,_e=o.onCascade,J=Object.keys(n).filter(function(G){return n[G]}).length>0,Y=function(){n.disabled||s(M.key)},ie=function(){n.disabled||d(M.key)},Q=(0,i.jsx)(Ae.Z,{className:"".concat(re,"-action-copy"),onClick:Y,style:{cursor:n.disabled?"not-allowed":"pointer",color:"#888888"}}),Ce=(0,i.jsx)(Ie.Z,{className:"".concat(re,"-action-remove"),onClick:ie,style:{cursor:n.disabled?"not-allowed":"pointer",color:"#888888"}});if(Z){var ye,Me=Z({type:(ye=this.props.children)===null||ye===void 0?void 0:ye.type,namePath:M.namePath,isRoot:!M.parent,data:M.data,disabled:n.disabled||!1},{remove:ie,copy:Y}),ge=Me.remove,ee=Me.copy;ge&&(Ce=ge),ee&&(Q=ee)}return(0,i.jsx)("div",{className:xe()("field","index-".concat(R.index),{"index-latest":R.index===R.length-1,"index-first":R.index===0},"id-".concat(p)),children:(0,i.jsx)(Je,{thisKey:M.key,onMove:b,namePath:M.namePath,disabled:n.disabled,rowConfig:n,nodeType:"FIELD",currentIndex:R.index,dragger:(0,i.jsx)(Ue.Z,{className:"".concat(re,"-action-drag"),style:{color:"#595959"}}),children:(0,i.jsx)("div",{className:"field-content",children:(0,i.jsxs)(Ve,{children:[U.map(function(G){return(0,h.createElement)(rn,m()(m()({},G),{},{key:"field-".concat(p,"-").concat(G.name,"-container"),currentKey:p,currentNode:M,rowConfig:n,form:z,indexParams:R,cascades:le,onCascade:_e}))}),J&&(0,i.jsxs)(Ve,{children:[n.copyable&&Q,n.removable&&Ce]})]})})},M.key+"-field")},p)}}]),a}(h.Component),an=e(51042),on=function(r){var a=r.children;return(0,i.jsx)(i.Fragment,{children:a})},ln=function(F){q()(a,F);var r=ce()(a);function a(){return D()(this,a),r.apply(this,arguments)}return P()(a,[{key:"shouldComponentUpdate",value:function(o){return this.props.value!==o.value}},{key:"render",value:function(){var o=this.props,n=o.children,s=o.value,d=o.onChange,p=o.rowConfig;return h.cloneElement(n,m()(m()(m()({},n.props),{disabled:p.disabled}),{value:s,onChange:d}))}}]),a}(h.Component),dn=function(F){q()(a,F);var r=ce()(a);function a(){return D()(this,a),r.apply(this,arguments)}return P()(a,[{key:"shouldComponentUpdate",value:function(o){return!0}},{key:"render",value:function(){var o=this,n=this.props,s=n.currentKey,d=n.currentNode,p=n.isRoot,M=n.indexParams,Z=n.id,R=n.rowConfig,b=n.onMove,U=n.relationRender,z=n.treeInstance,le=n.render,_e=n.handleAdd,J=n.modifyButton,Y=n.handleRemove,ie=d.children,Q=ie===void 0?[]:ie,Ce=p?on:Je,ye=p?["relation"]:[d.namePath.join(".")].concat("relation"),Me=m()({text:"\u6DFB\u52A0\u89C4\u5219",disabled:!1},(J==null?void 0:J({type:"add",depth:d.depth}))||{}),ge=m()({text:"\u6DFB\u52A0\u89C4\u5219\u7EC4",disabled:!1},(J==null?void 0:J({type:"addGroup",depth:d.depth}))||{});return(0,i.jsxs)("div",{className:xe()("relation-container","index-".concat(M.index),"id-".concat(s)),children:[(0,i.jsx)("div",{className:xe()("relation-node","relation-node-".concat(Z)),children:(0,i.jsx)("div",{className:xe()("relation",{"root-relation":p},"index-".concat(M.index),{"index-latest":M.index===M.length-1,"index-first":M.index===0}),children:(0,i.jsxs)(Ce,{thisKey:d.key,onMove:b,namePath:d.namePath,disabled:R.disabled,rowConfig:R,nodeType:"RELATION",collapse:!0,toggleCollapse:function(){},collapsible:!1,currentIndex:M.index,dragger:(0,i.jsx)(Ue.Z,{className:"".concat(re,"-action-drag"),style:{color:"#595959"}}),children:[(0,i.jsx)(A.ZP.Field,{name:ye,initialValue:d.data.relation,children:function(G){var Fe,Ke,Re=typeof U=="function"?U({depth:d.depth,parent:(Fe=d.parent)===null||Fe===void 0?void 0:Fe.data,brothers:(Ke=d.parent)===null||Ke===void 0?void 0:Ke.children.filter(function(k){return k.key!==d.key}).map(function(k){return m()({},k.data)}),isRoot:p,data:z.getChildrenData(d)}):U;return(0,i.jsx)(ln,{value:G.value,onChange:G.onChange,rowConfig:R,children:Re})}}),R.removable&&!p&&(0,i.jsx)("div",{style:{paddingRight:4},children:(0,i.jsx)(Ie.Z,{onClick:function(){R.disabled||Y(d.key)},style:{cursor:R.disabled?"not-allowed":"pointer",color:"#888"}})})]},d.key+"-relation")})}),(0,i.jsxs)("div",{className:"relation-children",children:[(0,i.jsx)("div",{className:xe()("relation-line","relation-line-".concat(Z)),"data-namepath":d.namePath.join(",")}),Q.map(function(ee,G){var Fe,Ke,Re;return(0,i.jsxs)(h.Fragment,{children:[G===0&&(0,i.jsx)(Ge,{order:G,parentKey:d.key,parentNamePath:d.namePath,relatedKeys:G>0?[ee.key,(Fe=ee.parent)===null||Fe===void 0?void 0:Fe.key,Q[G-1].key]:[ee.key,(Ke=ee.parent)===null||Ke===void 0?void 0:Ke.key],children:(0,i.jsx)("div",{className:"drop-inner"})},s+G+"dp"),le(ee,{index:G,length:Q.length},o.props.mapKey),(0,i.jsx)(Ge,{order:G+1,parentNamePath:d.namePath,parentKey:d.key,relatedKeys:[ee.key,(Re=ee.parent)===null||Re===void 0?void 0:Re.key],children:(0,i.jsx)("div",{className:"drop-inner"})},s+G+1+"dp")]},s+G)}),(0,i.jsxs)("div",{className:"button",children:[(0,i.jsxs)("div",{onClick:function(){Me.disabled||_e(d.key,"FIELD")},className:xe()("button-add","button-add-rule",{disabled:Me.disabled}),children:[(0,i.jsx)(an.Z,{}),Me.text]}),(0,i.jsx)("div",{onClick:function(){ge.disabled||_e(d.key,"RELATION")},className:xe()("button-add","button-add-rule-group",{disabled:ge.disabled}),children:ge.text})]})]})]},s)}}]),a}(h.Component),un=e(68400),sn=e.n(un),Ye=e(52156),Be=(0,Ye.Z)({key:"tech-ui-rule-tree",container:document.body||void 0}),Kn=Be.flush,Ln=Be.hydrate,Zn=Be.cx,Fn=Be.merge,Un=Be.getRegisteredStyles,Wn=Be.injectGlobal,bn=Be.keyframes,Vn=Be.css,Nn=Be.sheet,Sn=Be.cache,_n=function(r){return(0,Ye.Z)({key:r,container:document.body||void 0})},Xe,cn="rule-tree",Se=_n(cn),He=Se.css,vn=Se.cx,$n=Se.keyframes,mn=function(r){return He(Xe||(Xe=sn()([`
  position: relative;
  .relation-container {
    display: flex;
    gap: `,`px;
  }
  .relation-node {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .relation-children {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: `,`px;
    justify-content: center;
    .relation-line {
      position: absolute;
      left: -28px;
      border-left: solid 1px `,`;
    }
  }
  .field {
    position: relative;
    display: flex;
    align-items: center;
    &::before {
      position: absolute;
      left: -`,`px;
      width: `,`px;
      border-top: solid `,` 1px;
      content: '';
    }
  }
  .relation {
    position: relative;
    display: flex;
    align-items: center;
    &:not(.root-relation) {
      &::before {
        position: absolute;
        left: -`,`px;
        width: `,`px;
        border-top: solid `,` 1px;
        content: '';
      }
    }

    &::after {
      position: absolute;
      right: -`,`px;
      width: `,`px;
      border-top: solid `,` 1px;
      content: '';
    }
  }
  .button {
    position: relative;
    display: flex;
    gap: 2px;
    align-items: center;
    .button-add {
      padding: 4px 8px;
      color: rgba(0, 0, 0, 0.65);
      white-space: nowrap;
      background-color: rgba(0, 0, 0, 0.05);
      border-radius: 3px;
      cursor: pointer;
      &.disabled {
        cursor: not-allowed;
      }
    }
    &::after {
      position: absolute;
      left: -`,`px;
      width: `,`px;
      border-top: solid `,` 1px;
      content: '';
    }
  }
  .drop-inner {
    width: 100%;
    height: 10px;
  }
  .drag-container-field {
    padding: 4px 8px;
    background-color: `,`;
    border-radius: 3px;
  }
  .drag-container-relation {
    box-sizing: border-box;
    padding: 0 3px; // \u51CF\u53BB border
    border: solid `,` 1px;
    border-radius: 3px;
  }
  .drag-container {
    display: flex;
    align-items: center;
  }
  .drop-placement {
    position: relative;
    width: 56px;
    border: dashed 1px `,`;
    border-radius: 3px;
  }
  #svg-drag {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 10;
    width: 100%;
    height: 100%;
    opacity: 1;
    pointer-events: none;
  }
`])),r.GapJustify,r.GapAlign,r.ColorBorder,r.GapJustifyMid,r.GapJustifyMid,r.ColorBorder,r.GapJustifyMid,r.GapJustifyMid,r.ColorBorder,r.GapJustifyMid,r.GapJustifyMid,r.ColorBorder,r.GapJustifyMid,r.GapJustifyMid,r.ColorBorder,r.BgcField,r.ColorBorder,r.ColorBorderDropPlacement)},ze={GapJustify:56,GapJustifyMid:28,GapAlign:4,BgcField:"rgba(0, 0, 0, 0.05)",ColorBorder:"#e6e6e6",ColorBorderDropPlacement:"#1890ff"},Qe=function(r){var a=m()(m()({},ze),r);return m()(m()({},r),a)},hn=Qe(ze),ke=h.createContext(hn),fn=function(r){return(0,i.jsx)(ke.Provider,{value:m()({},Qe((r==null?void 0:r.token)||{})),children:r.children})},En=function(){return(0,i.jsxs)("select",{children:[(0,i.jsx)("option",{value:"and",children:"\u5E76\u4E14"}),(0,i.jsx)("option",{value:"or",children:"\u6216\u8005"})]})},Pn=function(r){var a=r.value,l=r.onChange,o=r.relationRender,n=o===void 0?En:o,s=r.fields,d=r.onCascade,p=r.cascades,M=r.noDndProvider,Z=M===void 0?!1:M,R=r.onRemove,b=r.defaultValue,U=r.modifyTreeNode,z=r.defaultRelationValue,le=z===void 0?"and":z,_e=r.id,J=_e===void 0?"default-rule-tree":_e,Y=r.style,ie=r.actionRef,Q=r.actionsRender,Ce=r.modifyButton,ye=A.ZP.useForm(),Me=C()(ye,1),ge=Me[0],ee=(0,h.useContext)(ke),G=s.map(function(he){return he.name}),Fe=(0,v.Z)(b,{value:a,onChange:l}),Ke=C()(Fe,2),Re=Ke[0],k=Ke[1],me=(0,h.useRef)(u.initWithData(Re,!1,G)),xn=(0,h.useState)(0),we=C()(xn,2),Cn=we[0],jn=we[1],qe=function(){return jn(function(V){return V+1})};(0,h.useEffect)(function(){De(ge,Re),pe(me.current)},[Cn]);var pn=function(V){me.current=V,qe()},yn=(0,h.useRef)({validate:function(){return ge.validateFields()},setData:function(V,X){var H,S,N=(H=me.current)===null||H===void 0?void 0:H.find("key",V);N&&(N.data=X,k==null||k((S=me.current)===null||S===void 0?void 0:S.getPureData()))},reRender:function(){qe()}});ie&&t().set(ie,"current",yn.current);var Mn=function(){return s.reduce(function(V,X){var H=X.initialValue,S=X.name;return t().merge(V,g()({},S,H))},{})},Rn=function(V,X){var H=Mn(),S=u.getNewInstance(me.current),N=S.createNode(X==="RELATION"?{relation:le}:H,X);if(S.appendByKey(V,N),X===x){var Te=S.createNode(H,"FIELD");S.appendByKey(N.key,Te)}k==null||k(S.getPureData())},$e=function he(V,X,H){var S=X||u.getNewInstance(me.current),N=S.find("key",V);if(R&&!H){var Te=R(N.type,N.namePath,N.data);if(!Te)return}var be=N.parent;S.removeByKey(V),!S.isRoot(be)&&be.children.length===0?he(be.key,S,H):k==null||k(S.getPureData())},Tn=function(V){var X=u.getNewInstance(me.current),H=X.find("key",V);if(H){var S=H.data,N=H.parent,Te=X.createNode(t().clone(S),"FIELD");X.appendByKey(N.key,Te),k==null||k(X.getPureData())}},en=function(V,X,H,S){var N=u.getNewInstance(me.current),Te=N.find("key",V),be=Te.parent,In=N.find("key",X);In.namePath.length!==Te.namePath.length-1?N.move(V,X,S):N.move(V,X,H),be.type===x&&be.children.length===0?$e(be.key,N,!0):k==null||k(N.getPureData())};te(),(0,h.useEffect)(function(){Re&&pn(u.initWithData(Re,!1,G))},[Re]);var An=function he(V){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{index:0,length:0},H=arguments.length>2?arguments[2]:void 0,S=$(V.namePath),N={copyable:!1,draggable:!0,disabled:!1,removable:V.type==="FIELD",className:""},Te=me.current.isRoot(V);if(U&&(N=m()(m()({},N),U({type:V.type,namePath:V.namePath,data:V.data,isRoot:Te}))),V.type==="RELATION")return(0,i.jsx)(dn,{mapKey:H,nodeKey:V.key,render:he,currentKey:S,currentNode:V,isRoot:Te,rowConfig:N,indexParams:X,id:J,onMove:en,treeInstance:me.current,handleAdd:Rn,relationRender:n,modifyButton:Ce,handleRemove:$e},S);if(V.type==="FIELD")return(0,i.jsx)(tn,{form:ge,fields:s,onMove:en,cascades:p,onCascade:d,rowConfig:N,handleCopy:Tn,handleRemove:$e,currentKey:S,currentNode:V,indexParams:X,actionsRender:Q},S)};return(0,i.jsx)("div",{className:vn("rule-tree",mn(ee),He("position: relative;")),style:Y,children:(0,i.jsxs)(L,{noDndProvider:Z,children:[(0,i.jsx)("svg",{id:"svg-drag"}),(0,i.jsx)(A.ZP,{form:ge,component:"div",onValuesChange:function(V,X){var H,S;(H=me.current)===null||H===void 0||H.bfs((S=me.current)===null||S===void 0?void 0:S.getRoot(),function(N){t().isEqual(N.namePath,[])?t().set(N,"data.relation",X.relation):t().set(N,"data",m()(m()({},X[N.namePath.join(".")]),N.type===x?{children:N.data.children}:{}))}),k==null||k(me.current.getPureData())},children:An(me.current.getRoot(),void 0,me.current.getCurrentMap())})]})})},gn=function(r){return(0,i.jsx)(fn,{token:r==null?void 0:r.token,children:(0,i.jsx)(Pn,m()({},r))})},Dn=gn,On=Dn},2903:function(){}}]);
